<div class="ui-table">
  <div class="ui-table__scroll">
    <table class="ui-table__table" [ngClass]="loading ? 'table-fixed' : ''">
      <thead>
        <tr>
          @for (c of columns; track c.key) {
            <th
              class="ui-table__head"
              [ngClass]="c.widthClass ?? ''"
            >
              {{ c.headerKey | translate }}
            </th>
          }
          <th class="ui-table__head">
            {{ 'common.actions' | translate }}
          </th>
        </tr>
        @if (showFilters) {
          <ng-content select="[table-filters]"></ng-content>
        }
      </thead>

      @if (!loading) {
        <tbody>
          @for (row of data; track $index) {
            <tr>
              @for (c of columns; track c.key) {
                <td
                  class="ui-table__cell"
                  [ngClass]="c.widthClass ?? ''"
                  [attr.data-label]="c.headerKey | translate"
                >
                  @if (c.type === 'badge') {
                    <app-ui-badge
                      [text]="displayCell(c, row)"
                      [color]="badgeColor(c, row)"
                      [badgeClass]="badgeClass(c, row)"
                      [icon]="badgeIcon(c, row)"
                      [iconPosition]="badgeIconPosition(c, row)"
                      [iconClass]="badgeIconClass(c, row)"
                    ></app-ui-badge>
                  } @else if (c.type === 'toggle') {
                    <div class="ui-table__toggle-wrap">
                      <span class="ui-table__toggle" [class.ui-table__toggle--on]="toggleOn(c, row)">
                        <span class="ui-table__toggle-knob" aria-hidden="true"></span>
                      </span>
                      <span class="ui-table__toggle-label">{{ displayCell(c, row) }}</span>
                    </div>
                  } @else {
                    <span>{{ displayCell(c, row) }}</span>
                  }
                </td>
              }
              <td class="ui-table__cell" [attr.data-label]="'common.actions' | translate">
                @if (rowActionsTemplate) {
                  <ng-container
                    [ngTemplateOutlet]="rowActionsTemplate"
                    [ngTemplateOutletContext]="{ $implicit: row }"
                  ></ng-container>
                } @else {
                  <app-ui-button size="sm" variant="ghost" type="button" (click)="rowAction.emit(row)">
                    <i class="ri-eye-line ui-button__icon" aria-hidden="true"></i>
                    {{ rowActionLabelKey | translate }}
                  </app-ui-button>
                }
              </td>
            </tr>
          }

          @if (data.length === 0) {
            <tr>
              <td class="ui-table__empty" [attr.colspan]="columns.length + 1">
                {{ 'common.noData' | translate }}
              </td>
            </tr>
          }
        </tbody>
      } @else {
        <tbody>
          @for (i of [1,2,3,4,5,6,7,8,9,10]; track i) {
            <tr>
              @for (c of columns; track c.key) {
              <td
                class="ui-table__cell"
                [ngClass]="c.widthClass ?? ''"
                [attr.data-label]="c.headerKey | translate"
              >
                <div class="ui-table__skeleton ui-table__skeleton--line"></div>
              </td>
            }
            <td class="ui-table__cell" [attr.data-label]="'common.actions' | translate">
              <div class="ui-table__skeleton ui-table__skeleton--button"></div>
            </td>
          </tr>
          }
        </tbody>
      }
    </table>
  </div>

  <div class="ui-table__footer">
    <div class="ui-table__total">{{ 'common.total' | translate }}: <b>{{ total }}</b></div>

    <div class="ui-table__pager">
      <app-ui-pagination
        [page]="page"
        [pageSize]="pageSize"
        [total]="total"
        [pageWindow]="pageWindow"
        (pageChange)="onPageChange($event)"
      />
    </div>
  </div>
</div>
