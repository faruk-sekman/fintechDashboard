<form class="ui-form" [ngClass]="formClass" [formGroup]="form" (ngSubmit)="onSubmit($event)" [attr.id]="id || null">
  @for (f of fields; track f.name; let i = $index) {
    <div class="ui-form__field" [ngClass]="f.fieldClass ?? null">
        <label class="ui-form__label" [attr.for]="fieldId(f.name, i)">
          {{ f.labelKey | translate }}
        </label>

      @switch (f.type) {
        @case ('text') {
          <div class="ui-form__control-row">
            <app-ui-input
              [id]="fieldId(f.name, i)"
              [control]="control(f.name)"
              [inputClass]="controlClass(f.name, f.controlClass)"
              [placeholder]="f.placeholderKey ? (f.placeholderKey | translate) : null"
              [mask]="f.inputMask ?? null"
              [readOnly]="!!f.readOnly"
              [disabled]="!!f.disabled"
              [ariaInvalid]="isInvalid(f.name)"
            />
            <i
              class="ui-form__status-icon"
              [class.ui-form__status-icon--hidden]="!showStatus(f.name)"
              [class.ui-form__status-icon--invalid]="isInvalid(f.name)"
              [class.ui-form__status-icon--valid]="isValid(f.name)"
              [class.ri-error-warning-line]="isInvalid(f.name)"
              [class.ri-checkbox-circle-line]="isValid(f.name)"
              aria-hidden="true"
            ></i>
          </div>
        }
        @case ('email') {
          <div class="ui-form__control-row">
            <app-ui-input
              type="email"
              [id]="fieldId(f.name, i)"
              [control]="control(f.name)"
              [inputClass]="controlClass(f.name, f.controlClass)"
              [placeholder]="f.placeholderKey ? (f.placeholderKey | translate) : null"
              [mask]="f.inputMask ?? null"
              [readOnly]="!!f.readOnly"
              [disabled]="!!f.disabled"
              [ariaInvalid]="isInvalid(f.name)"
            />
            <i
              class="ui-form__status-icon"
              [class.ui-form__status-icon--hidden]="!showStatus(f.name)"
              [class.ui-form__status-icon--invalid]="isInvalid(f.name)"
              [class.ui-form__status-icon--valid]="isValid(f.name)"
              [class.ri-error-warning-line]="isInvalid(f.name)"
              [class.ri-checkbox-circle-line]="isValid(f.name)"
              aria-hidden="true"
            ></i>
          </div>
        }
        @case ('number') {
          <div class="ui-form__control-row">
            <app-ui-input
              type="number"
              [id]="fieldId(f.name, i)"
              [control]="control(f.name)"
              [inputClass]="controlClass(f.name, f.controlClass)"
              [mask]="f.inputMask ?? null"
              [readOnly]="!!f.readOnly"
              [disabled]="!!f.disabled"
              [ariaInvalid]="isInvalid(f.name)"
            />
            <i
              class="ui-form__status-icon"
              [class.ui-form__status-icon--hidden]="!showStatus(f.name)"
              [class.ui-form__status-icon--invalid]="isInvalid(f.name)"
              [class.ui-form__status-icon--valid]="isValid(f.name)"
              [class.ri-error-warning-line]="isInvalid(f.name)"
              [class.ri-checkbox-circle-line]="isValid(f.name)"
              aria-hidden="true"
            ></i>
          </div>
        }
        @case ('date') {
          <div class="ui-form__control-row">
            <app-ui-input
              type="date"
              [id]="fieldId(f.name, i)"
              [control]="control(f.name)"
              [lang]="dateInputLang()"
              [inputClass]="controlClass(f.name, f.controlClass)"
              [mask]="f.inputMask ?? null"
              [readOnly]="!!f.readOnly"
              [disabled]="!!f.disabled"
              [ariaInvalid]="isInvalid(f.name)"
            />
            <i
              class="ui-form__status-icon"
              [class.ui-form__status-icon--hidden]="!showStatus(f.name)"
              [class.ui-form__status-icon--invalid]="isInvalid(f.name)"
              [class.ui-form__status-icon--valid]="isValid(f.name)"
              [class.ri-error-warning-line]="isInvalid(f.name)"
              [class.ri-checkbox-circle-line]="isValid(f.name)"
              aria-hidden="true"
            ></i>
          </div>
        }
        @case ('datetime-local') {
          <div class="ui-form__control-row">
            <app-ui-input
              type="datetime-local"
              [id]="fieldId(f.name, i)"
              [control]="control(f.name)"
              [inputClass]="controlClass(f.name, f.controlClass)"
              [mask]="f.inputMask ?? null"
              [readOnly]="!!f.readOnly"
              [disabled]="!!f.disabled"
              [ariaInvalid]="isInvalid(f.name)"
            />
            <i
              class="ui-form__status-icon"
              [class.ui-form__status-icon--hidden]="!showStatus(f.name)"
              [class.ui-form__status-icon--invalid]="isInvalid(f.name)"
              [class.ui-form__status-icon--valid]="isValid(f.name)"
              [class.ri-error-warning-line]="isInvalid(f.name)"
              [class.ri-checkbox-circle-line]="isValid(f.name)"
              aria-hidden="true"
            ></i>
          </div>
        }
        @case ('select') {
          <div class="ui-form__control-row">
            <app-ui-select
              [id]="fieldId(f.name, i)"
              [control]="control(f.name)"
              [options]="f.options ?? []"
              [inputClass]="controlClass(f.name, f.controlClass)"
              [readOnly]="!!f.readOnly"
              [disabled]="!!f.disabled"
              [ariaInvalid]="isInvalid(f.name)"
            />
            <i
              class="ui-form__status-icon"
              [class.ui-form__status-icon--hidden]="!showStatus(f.name)"
              [class.ui-form__status-icon--invalid]="isInvalid(f.name)"
              [class.ui-form__status-icon--valid]="isValid(f.name)"
              [class.ri-error-warning-line]="isInvalid(f.name)"
              [class.ri-checkbox-circle-line]="isValid(f.name)"
              aria-hidden="true"
            ></i>
          </div>
        }
        @case ('checkbox') {
          <div class="ui-form__control-row">
            <app-ui-checkbox
              [id]="fieldId(f.name, i)"
              [control]="control(f.name)"
              [inputClass]="controlClass(f.name, f.controlClass)"
              [label]="f.hintKey ? (f.hintKey | translate) : (f.labelKey | translate)"
              [readOnly]="!!f.readOnly"
              [disabled]="!!f.disabled"
            />
          
          </div>
        }
      }

      <div class="ui-form__error" [class.ui-form__error--hidden]="!hasDisplayError(f.name)">
        @if (displayError(f.name); as err) {
          {{ err.key | translate: err.params }}
        }
      </div>
    </div>
  }

  @if (showSubmit) {
    <app-ui-button type="submit" [disabled]="loading || form.invalid || !hasChanges">
      @if (!loading) {
        <span>{{ submitLabelKey | translate }}</span>
      } @else {
        <span>{{ 'common.saving' | translate }}</span>
      }
    </app-ui-button>
  }
</form>
